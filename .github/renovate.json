{
  "automergeStrategy": "merge-commit",
  "platformAutomerge": true,
  "lockFileMaintenance": {
    "enabled": true
  },
  "customDatasources": {
    "golang-with-checksum": {
      "defaultRegistryUrlTemplate": "https://go.dev/dl/?mode=json&include=all",
      "format": "json",
      "transformTemplates": [
        "{\"releases\": $[stable=true].files[os='linux' and arch='amd64' and kind='archive'].{\"version\": $substring(version, 2), \"digest\": sha256}}"
      ]
    }
  },
  "tekton": {
    "schedule": [
      "* * * * *"
    ],
    "includePaths": [
      ".tekton/**"
    ]
  },
  "regexManagers": [
    {
      "description": "Track Helm version in Tekton pipelines",
      "fileMatch": [
        "^\\.tekton/.*\\.ya?ml$"
      ],
      "matchStrings": [
        "name:\\s+helm-version\\s+description:.*?\\s+type:.*?\\s+default:\\s+\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "helm/helm",
      "extractVersionTemplate": "^v?(?<version>.*)$"
    },
    {
      "description": "Track Go version and SHA256 in devcontainer Containerfile",
      "fileMatch": [
        "^\\.devcontainer/Containerfile$"
      ],
      "matchStrings": [
        "ARG GO_VERSION=(?<currentValue>.*?)\\s+ARG GO_SHA256=(?<currentDigest>\\S+)"
      ],
      "datasourceTemplate": "custom.golang-with-checksum",
      "depNameTemplate": "{{currentValue}}",
      "versioningTemplate": "loose"
    }
  ],
  "packageRules": [
    {
      "description": "Group all cert-manager components",
      "groupName": "cert-manager",
      "automerge": true,
      "autoApprove": true,
      "matchPackageNames": [
        "cert-manager",
        "github.com/cert-manager/cert-manager",
        "/^quay.io/jetstack/cert-manager-/"
      ]
    },
    {
      "description": "Auto-merge patch updates for Konflux components",
      "matchUpdateTypes": [
        "patch",
        "digest"
      ],
      "automerge": true,
      "autoApprove": true,
      "matchPackageNames": [
        "/^quay.io/konflux-ci//"
      ]
    },
    {
      "description": "Group Tekton bundle updates together",
      "groupName": "tekton-bundles",
      "automerge": true,
      "autoApprove": true,
      "matchPackageNames": [
        "/quay.io/konflux-ci/tekton-catalog//"
      ]
    },
    {
      "description": "Group container base image updates",
      "groupName": "container-images",
      "matchUpdateTypes": [
        "patch",
        "digest"
      ],
      "automerge": true,
      "autoApprove": true,
      "matchPackageNames": [
        "/registry.access.redhat.com//",
        "/registry.fedoraproject.org//"
      ]
    },
    {
      "description": "Auto-merge Go toolchain patch updates (go.mod and Containerfile)",
      "groupName": "go-toolchain",
      "matchDatasources": [
        "golang-version",
        "custom.golang-with-checksum"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "automerge": true,
      "autoApprove": true
    }
  ]
}
